<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: SelectOptions.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: SelectOptions.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module SelectOptions */
import * as Contents from "./Contents.js";
import * as Grouping from "./Grouping.js";
import * as Notification from "./Notification.js";
import InfoBox from "./InfoBox.js";
import SplitHandler from "./SplitHandler.js";

/**
 * The NeonView parent to call editor actions.
 * @type {NeonView}
 */
var neonView;

/**
 * Initialize NeonView for this and {@link module:Grouping}
 * @param {NeonView} view - The parent NeonView.
 */
export function initNeonView(view) {
    neonView = view;
    Grouping.initNeonView(view);
}

//TODO: CHANGE NAVABAR-LINK TO PROPER ICON//
/**
 * Trigger the extra nc action menu.
 * @param {SVGSVGElement} nc - The last selected elements.
 */
export function triggerNcActions(nc) {
    endOptionsSelection();
    $("#moreEdit").removeClass("is-invisible");
    $("#moreEdit").append(Contents.ncActionContents);

    $("#Punctum.dropdown-item").on("click", (evt) => {
        let unsetInclinatum = {
            "action": "set",
            "param": {
                "elementId": nc.id,
                "attrType": "name",
                "attrValue": ""
            }
        };
        let unsetVirga = {
            "action": "set",
            "param": {
                "elementId": nc.id,
                "attrType": "diagonalright",
                "attrValue": ""
            }
        };
        if(neonView.edit({ "action": "chain", "param": [ unsetInclinatum, unsetVirga ]})){
            Notification.queueNotification("Shape Changed");
        }
        else{
            Notification.queueNotification("Shape Change Failed");
        }
        endOptionsSelection();
        neonView.refreshPage();
    });

    $("#Inclinatum.dropdown-item").on("click", (evt) => {
        let setInclinatum = {
            "action": "set",
            "param": {
                "elementId": nc.id,
                "attrType": "name",
                "attrValue": "inclinatum"
            }
        };
        let unsetVirga = {
            "action": "set",
            "param": {
                "elementId": nc.id,
                "attrType": "diagonalright",
                "attrValue": ""
            }
        };
        if(neonView.edit({ "action": "chain", "param": [ setInclinatum, unsetVirga ]})){
            Notification.queueNotification("Shape Changed");
        }
        else{
            Notification.queueNotification("Shape Change Failed");
        }
        endOptionsSelection();
        neonView.refreshPage();
    });

    $("#Virga.dropdown-item").on("click", (evt) => {
        let unsetInclinatum = {
            "action": "set",
            "param": {
                "elementId": nc.id,
                "attrType": "name",
                "attrValue": ""
            }
        };
        let setVirga = {
            "action": "set",
            "param": {
                "elementId": nc.id,
                "attrType": "diagonalright",
                "attrValue": "u"
            }
        };
        if(neonView.edit({ "action": "chain", "param": [ unsetInclinatum, setVirga ]})){
            Notification.queueNotification("Shape Changed");
        }
        else{
            Notification.queueNotification("Shape Change Failed");
        }
        endOptionsSelection();
        neonView.refreshPage();
    });

    initOptionsListeners();
}

/**
 * Trigger extra neume actions.
 */
export function triggerNeumeActions() {
    endOptionsSelection()
    $("#moreEdit").removeClass("is-invisible");
    $("#moreEdit").append(Contents.neumeActionContents);
    var neume = $(".selected");
    if (neume.length != 1){
        console.warn("More than one neume selected! Cannot trigger Neume ClickSelect actions.");
        return;
    }

    $(".grouping").on("click", (e) => {
        var contour = InfoBox.getContourByValue(e.target.id);
        triggerChangeGroup(contour);
    });

    function triggerChangeGroup(contour) {
        let changeGroupingAction = {
            "action": "changeGroup",
            "param": {
                "elementId": neume[0].id,
                "contour": contour
            }
        }
        if(neonView.edit(changeGroupingAction)){
            Notification.queueNotification("Grouping Changed");
        }
        else{
            Notification.queueNotification("Grouping Failed");
        }
        endOptionsSelection();
        neonView.refreshPage();
    }
    initOptionsListeners();
    Grouping.initGroupingListeners();
}

/**
 * Trigger extra syllable actions.
 */
export function triggerSylActions() {
    endOptionsSelection()
    $("#moreEdit").removeClass("is-invisible");
    $("#moreEdit").append(
        "&lt;div>&lt;p class='control'>" +
        "&lt;button class='button' id='ungroupNeumes'>Ungroup&lt;/button>&lt;/p>&lt;/div>"
    );
    Grouping.initGroupingListeners();
}

/**
 * Trigger extra clef actions.
 */
export function triggerClefActions(clef) {
    endOptionsSelection();
    $("#moreEdit").removeClass("is-invisible");
    $("#moreEdit").append(Contents.clefActionContents);
    $("#CClef.dropdown-item").on("click", (evt) => {
        let setCClef = {
            "action": "setClef",
            "param": {
                "elementId": clef.id,
                "shape": "C"
            }
        }
        if(neonView.edit(setCClef)){
            Notification.queueNotification("Shape Changed");
        }
        else{
            Notification.queueNotification("Shape Change Failed");
        }
        endOptionsSelection();
        neonView.refreshPage();
    })
    $("#FClef.dropdown-item").on("click", (evt) => {
        let setFClef = {
            "action": "setClef",
            "param": {
                "elementId": clef.id,
                "shape": "F"
            }
        }
        if(neonView.edit(setFClef)){
            Notification.queueNotification("Shape Changed");
        }
        else{
            Notification.queueNotification("Shape Change Failed");
        }
        endOptionsSelection();
        neonView.refreshPage();
    })
    initOptionsListeners();
}

/**
 * Trigger extra staff actions.
 */
export function triggerStaffActions() {
    endOptionsSelection();
    $("#moreEdit").removeClass("is-invisible");
    $("#moreEdit").append(Contents.staffActionContents);

    $("#merge-systems").on("click", (evt) => {
        let systems = Array.from($(".staff.selected"));
        let elementIds = [];
        systems.forEach(staff => {
            elementIds.push(staff.id);
        });
        let editorAction = {
            "action": "merge",
            "param": {
                "elementIds": elementIds
            }
        };
        if (neonView.edit(editorAction)) {
            Notification.queueNotification("Staff Merged");
            endOptionsSelection();
            neonView.refreshPage();
        }
        else {
            Notification.queueNotification("Merge Failed");
        }
    });
}

/**
 * Trigger split staff option
 */
export function triggerSplitActions() {
    endOptionsSelection();
    $("#moreEdit").removeClass("is-invisible");
    $("#moreEdit").append(Contents.splitActionContents);

    //TODO add trigger for split action
    $("#split-system").on("click", (evt) => {
        var split = new SplitHandler(neonView);
        split.startSplit();
        endOptionsSelection();
    });
}

/**
 * End the extra options menu.
 */
export function endOptionsSelection () {
    $("#moreEdit").empty();
    $("#moreEdit").addClass("is-invisible");
}

/**
 * Initialize extra dropdown options.
 */
function initOptionsListeners(){
    $("#drop_select").on("click", function() {
        $(this).toggleClass("is-active");
    })
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Color.html">Color</a></li><li><a href="module-Compatibility.html">Compatibility</a></li><li><a href="module-Contents.html">Contents</a></li><li><a href="module-Controls.html">Controls</a></li><li><a href="module-Cursor.html">Cursor</a></li><li><a href="module-Grouping.html">Grouping</a></li><li><a href="module-Neon.html">Neon</a></li><li><a href="module-Notification.html">Notification</a></li><li><a href="module-ResizeStaff.html">ResizeStaff</a></li><li><a href="module-Select.html">Select</a></li><li><a href="module-SelectOptions.html">SelectOptions</a></li><li><a href="module-Text.html">Text</a></li><li><a href="module-Warnings.html">Warnings</a></li><li><a href="module-Zoom.html">Zoom</a></li></ul><h3>Classes</h3><ul><li><a href="DragHandler.html">DragHandler</a></li><li><a href="EditMode.html">EditMode</a></li><li><a href="InfoBox.html">InfoBox</a></li><li><a href="InsertHandler.html">InsertHandler</a></li><li><a href="module-Neon-Neon.html">Neon</a></li><li><a href="module-Notification-Notification.html">Notification</a></li><li><a href="module-ResizeStaff-Resize.html">Resize</a></li><li><a href="module-Select.ClickSelect.html">ClickSelect</a></li><li><a href="module-Select.DragSelect.html">DragSelect</a></li><li><a href="module-Zoom.ViewBox.html">ViewBox</a></li><li><a href="module-Zoom-ZoomHandler.html">ZoomHandler</a></li><li><a href="NeonView.html">NeonView</a></li><li><a href="SplitHandler.html">SplitHandler</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Aug 28 2018 15:08:46 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
